{"uid":"6103e48422fe7640","name":"Get all challenges with headers=None","fullName":"tests.test_challenges.TestChallenges#test_get_challenges","historyId":"ed59db8a5352c4f7687b74772bf34184","time":{"start":1747770710566,"stop":1747770710627,"duration":61},"description":"\n        Тестирует GET /challenges с различными заголовками.\n        ","descriptionHtml":"<pre><code>    Тестирует GET /challenges с различными заголовками.\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: Expected status code 401, got 200","statusTrace":"self = <test_challenges.TestChallenges object at 0x7fe41540e360>\nchallenges_client = <clients.challenges_client.ChallengesClient object at 0x7fe41512b410>\nheaders = None, expected_status = <HTTPStatus.UNAUTHORIZED: 401>\n\n    @pytest.mark.regression\n    @allure.title(\"Get all challenges with headers={headers}\")\n    @pytest.mark.parametrize(\n        \"headers, expected_status\",\n        [\n            (None, HTTPStatus.UNAUTHORIZED),  # Заголовки по умолчанию (из settings)\n            ({\"X-Challenger\": \"\"}, HTTPStatus.OK),  # Пустой X-Challenger\n            ({\"X-Challenger\": \"test_token\", \"Accept\": \"application/xml\"}, HTTPStatus.UNAUTHORIZED),  # Дополнительный заголовок\n            ({\"Authorization\": \"Bearer invalid\"}, HTTPStatus.OK),  # Неверный заголовок\n        ],\n        ids=[\n            \"default_headers\",\n            \"empty_headers\",\n            \"Accept_with_application/xml\",\n            \"invalid_authorization\"\n        ]\n    )\n    def test_get_challenges(self, challenges_client: ChallengesClient, headers: dict | None, expected_status: int):\n        \"\"\"\n        Тестирует GET /challenges с различными заголовками.\n        \"\"\"\n        response = challenges_client.get_challenges_api(headers=headers)\n    \n>       ChallengesAsserts.assert_status_code(response, expected_status)\n\ntests/test_challenges.py:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nresponse = <Response [200 OK]>, expected_status = <HTTPStatus.UNAUTHORIZED: 401>\n\n    @staticmethod\n    @allure.step(\"Check status code is {expected_status}\")\n    def assert_status_code(response: Response, expected_status: int) -> None:\n        \"\"\"\n        Проверяет, что статус-код ответа равен ожидаемому.\n        \"\"\"\n        actual_status = response.status_code\n        if actual_status != expected_status:\n            allure.attach(\n                f\"Expected: {expected_status}\\nActual: {actual_status}\",\n                name=\"Status Code Mismatch\",\n                attachment_type=allure.attachment_type.TEXT\n            )\n>           raise AssertionError(f\"Expected status code {expected_status}, got {actual_status}\")\nE           AssertionError: Expected status code 401, got 200\n\ntools/assertions/base_assertions.py:25: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1747770710460,"stop":1747770710519,"duration":59},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"settings","time":{"start":1747770710519,"stop":1747770710520,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"client","time":{"start":1747770710521,"stop":1747770710565,"duration":44},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"challenges_client","time":{"start":1747770710565,"stop":1747770710565,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n        Тестирует GET /challenges с различными заголовками.\n        ","status":"failed","statusMessage":"AssertionError: Expected status code 401, got 200","statusTrace":"self = <test_challenges.TestChallenges object at 0x7fe41540e360>\nchallenges_client = <clients.challenges_client.ChallengesClient object at 0x7fe41512b410>\nheaders = None, expected_status = <HTTPStatus.UNAUTHORIZED: 401>\n\n    @pytest.mark.regression\n    @allure.title(\"Get all challenges with headers={headers}\")\n    @pytest.mark.parametrize(\n        \"headers, expected_status\",\n        [\n            (None, HTTPStatus.UNAUTHORIZED),  # Заголовки по умолчанию (из settings)\n            ({\"X-Challenger\": \"\"}, HTTPStatus.OK),  # Пустой X-Challenger\n            ({\"X-Challenger\": \"test_token\", \"Accept\": \"application/xml\"}, HTTPStatus.UNAUTHORIZED),  # Дополнительный заголовок\n            ({\"Authorization\": \"Bearer invalid\"}, HTTPStatus.OK),  # Неверный заголовок\n        ],\n        ids=[\n            \"default_headers\",\n            \"empty_headers\",\n            \"Accept_with_application/xml\",\n            \"invalid_authorization\"\n        ]\n    )\n    def test_get_challenges(self, challenges_client: ChallengesClient, headers: dict | None, expected_status: int):\n        \"\"\"\n        Тестирует GET /challenges с различными заголовками.\n        \"\"\"\n        response = challenges_client.get_challenges_api(headers=headers)\n    \n>       ChallengesAsserts.assert_status_code(response, expected_status)\n\ntests/test_challenges.py:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nresponse = <Response [200 OK]>, expected_status = <HTTPStatus.UNAUTHORIZED: 401>\n\n    @staticmethod\n    @allure.step(\"Check status code is {expected_status}\")\n    def assert_status_code(response: Response, expected_status: int) -> None:\n        \"\"\"\n        Проверяет, что статус-код ответа равен ожидаемому.\n        \"\"\"\n        actual_status = response.status_code\n        if actual_status != expected_status:\n            allure.attach(\n                f\"Expected: {expected_status}\\nActual: {actual_status}\",\n                name=\"Status Code Mismatch\",\n                attachment_type=allure.attachment_type.TEXT\n            )\n>           raise AssertionError(f\"Expected status code {expected_status}, got {actual_status}\")\nE           AssertionError: Expected status code 401, got 200\n\ntools/assertions/base_assertions.py:25: AssertionError","steps":[{"name":"Get all challenges","time":{"start":1747770710566,"stop":1747770710626,"duration":60},"status":"passed","steps":[],"attachments":[{"uid":"bc5f7c88eae14763","name":"Request","source":"bc5f7c88eae14763.txt","type":"text/plain","size":15},{"uid":"e6bb72eda74cbdc2","name":"Request Headers","source":"e6bb72eda74cbdc2.txt","type":"text/plain","size":148},{"uid":"87293bc404df164f","name":"Response Status","source":"87293bc404df164f.txt","type":"text/plain","size":20},{"uid":"538b06a0cf79a126","name":"Response Headers","source":"538b06a0cf79a126.txt","type":"text/plain","size":872},{"uid":"d388a4703f2ca033","name":"Response Body (JSON)","source":"d388a4703f2ca033.json","type":"application/json","size":11617}],"parameters":[{"name":"headers","value":"None"},{"name":"params","value":"None"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":5,"hasContent":true,"attachmentStep":false},{"name":"Check status code is <HTTPStatus.UNAUTHORIZED: 401>","time":{"start":1747770710626,"stop":1747770710626,"duration":0},"status":"failed","statusMessage":"AssertionError: Expected status code 401, got 200\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 202, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/New_Pet_Api/New_Pet_Api/tools/assertions/base_assertions.py\", line 25, in assert_status_code\n    raise AssertionError(f\"Expected status code {expected_status}, got {actual_status}\")\n","steps":[],"attachments":[{"uid":"e12ff38f59a0081c","name":"Status Code Mismatch","source":"e12ff38f59a0081c.txt","type":"text/plain","size":25}],"parameters":[{"name":"response","value":"<Response [200 OK]>"},{"name":"expected_status","value":"<HTTPStatus.UNAUTHORIZED: 401>"}],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"16ffe7b3319931f5","name":"log","source":"16ffe7b3319931f5.txt","type":"text/plain","size":814}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":2,"attachmentsCount":7,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"client::0","time":{"start":1747770710818,"stop":1747770710818,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"feature","value":"Challenges API"},{"name":"tag","value":"regression"},{"name":"tag","value":"challenges"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_challenges"},{"name":"subSuite","value":"TestChallenges"},{"name":"host","value":"pkrvmf6wy0o8zjz"},{"name":"thread","value":"2107-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_challenges"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"expected_status","value":"<HTTPStatus.UNAUTHORIZED: 401>"},{"name":"headers","value":"None"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["challenges","regression"]},"source":"6103e48422fe7640.json","parameterValues":["<HTTPStatus.UNAUTHORIZED: 401>","None"]}